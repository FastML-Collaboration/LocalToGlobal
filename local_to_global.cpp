#include "local_to_global.h"

const coords_t mapL0[] = {
  {   -12.729,    3.1565,    0.1374,     0.3168 },
  {   -9.7149,    3.1484,    0.1383,     0.3176 },
  {    -6.701,    3.1434,    0.1396,     0.3181 },
  {   -3.6867,    3.1396,    0.1413,     0.3185 },
  {   -0.6721,    3.1363,    0.1428,     0.3188 },
  {     2.342,    3.1318,    0.1444,     0.3193 },
  {    5.3548,    3.1291,    0.1461,     0.3196 },
  {    8.3703,    3.1252,    0.1479,     0.3200 },
  {   11.3815,    3.1187,    0.1492,     0.3206 },
  {  -12.7251,    2.9323,    0.5659,     0.3410 },
  {     -9.71,    2.9322,    0.5681,     0.3410 },
  {   -6.6959,    2.9314,    0.5708,     0.3411 },
  {    -3.682,    2.9309,    0.5737,     0.3412 },
  {   -0.6669,    2.9304,    0.5768,     0.3413 },
  {     2.349,    2.9287,    0.5792,     0.3414 },
  {    5.3627,    2.9271,    0.5812,     0.3416 },
  {     8.375,    2.9241,    0.5835,     0.3420 },
  {     11.39,    2.9168,    0.5846,     0.3428 },
  {  -12.7152,    2.6141,    1.0238,     0.3825 },
  {   -9.6996,    2.6141,    1.0263,     0.3825 },
  {    -6.685,    2.6162,    1.0295,     0.3822 },
  {    -3.671,    2.6184,     1.033,     0.3819 },
  {    -0.656,    2.6208,    1.0365,     0.3816 },
  {    2.3586,    2.6231,    1.0403,     0.3812 },
  {    5.3733,    2.6231,    1.0434,     0.3812 },
  {    8.3873,    2.6237,    1.0465,     0.3811 },
  {   11.4021,    2.6235,    1.0489,     0.3812 },
  {  -12.6973,    2.2882,    1.5799,     0.4370 },
  {    -9.684,    2.2846,    1.5799,     0.4377 },
  {     -6.67,    2.2809,    1.5792,     0.4384 },
  {   -3.6547,    2.2765,    1.5788,     0.4393 },
  {   -0.6393,    2.2721,    1.5784,     0.4401 },
  {    2.3754,    2.2673,    1.5781,     0.4411 },
  {    5.3891,    2.2639,    1.5775,     0.4417 },
  {     8.404,    2.2608,    1.5769,     0.4423 },
  {    11.418,    2.2598,    1.5762,     0.4425 },
  {  -12.6883,    1.9759,    2.1857,     0.5061 },
  {   -9.6773,    1.9747,    2.1826,     0.5064 },
  {   -6.6631,    1.9735,    2.1805,     0.5067 },
  {   -3.6487,    1.9743,    2.1792,     0.5065 },
  {    -0.635,    1.9759,    2.1789,     0.5061 },
  {    2.3781,    1.9774,     2.179,     0.5057 },
  {    5.3929,    1.9795,    2.1789,     0.5052 },
  {    8.4061,    1.9839,    2.1794,     0.5041 },
  {   11.4205,    1.9877,    2.1806,     0.5031 },
  {  -12.6917,    1.8455,    2.8702,     0.5419 },
  {   -9.6766,    1.8457,    2.8681,     0.5418 },
  {   -6.6633,    1.8464,    2.8666,     0.5416 },
  {   -3.6488,    1.8485,    2.8653,     0.5410 },
  {   -0.6351,    1.8504,    2.8643,     0.5404 },
  {    2.3789,    1.8531,    2.8637,     0.5396 },
  {    5.3931,    1.8553,    2.8628,     0.5390 },
  {    8.4062,    1.8576,    2.8619,     0.5383 },
  {   11.4205,    1.8617,    2.8612,     0.5371 },
  {  -12.6829,    1.9382,   -2.7225,     0.5159 },
  {   -9.6692,    1.9325,   -2.7248,     0.5175 },
  {   -6.6561,    1.9298,   -2.7274,     0.5182 },
  {   -3.6428,    1.9306,   -2.7299,     0.5180 },
  {   -0.6291,    1.9331,    -2.732,     0.5173 },
  {    2.3847,    1.9379,   -2.7338,     0.5160 },
  {    5.3986,    1.9443,   -2.7355,     0.5143 },
  {    8.4121,    1.9512,   -2.7371,     0.5125 },
  {    11.426,    1.9582,   -2.7383,     0.5107 },
  {   -12.754,    2.1139,   -2.1545,     0.4731 },
  {   -9.6696,    2.1878,   -2.1051,     0.4571 },
  {   -6.6556,    2.1858,    -2.107,     0.4575 },
  {    -3.642,    2.1865,   -2.1095,     0.4574 },
  {    -0.629,    2.1887,   -2.1125,     0.4569 },
  {    2.3853,    2.1913,   -2.1145,     0.4564 },
  {    5.3991,    2.1948,   -2.1174,     0.4556 },
  {    8.4136,    2.1989,     -2.12,     0.4548 },
  {   11.4283,    2.2025,   -2.1226,     0.4540 },
  {  -12.6775,    2.5115,   -1.5642,     0.3982 },
  {   -9.6653,      2.51,    -1.566,     0.3984 },
  {    -6.652,    2.5083,   -1.5676,     0.3987 },
  {   -3.6383,    2.5086,     -1.57,     0.3986 },
  {   -0.6247,    2.5098,   -1.5723,     0.3984 },
  {    2.3898,    2.5115,   -1.5747,     0.3982 },
  {    5.4039,    2.5138,   -1.5773,     0.3978 },
  {    8.4185,    2.5152,   -1.5803,     0.3976 },
  {   11.4331,    2.5155,   -1.5827,     0.3975 },
  {  -12.7466,    2.8733,   -1.0855,     0.3480 },
  {   -9.7309,    2.8719,   -1.0858,     0.3482 },
  {   -6.7172,    2.8689,   -1.0863,     0.3486 },
  {   -3.7018,    2.8639,   -1.0869,     0.3492 },
  {   -0.6877,    2.8577,   -1.0873,     0.3499 },
  {    2.3268,    2.8502,   -1.0871,     0.3509 },
  {    5.3409,    2.8433,   -1.0877,     0.3517 },
  {    8.3541,    2.8363,   -1.0883,     0.3526 },
  {   11.3688,    2.8322,   -1.0882,     0.3531 },
  {  -12.7466,    3.1009,    -0.655,     0.3225 },
  {    -9.732,    3.0953,    -0.655,     0.3231 },
  {    -6.718,      3.09,   -0.6547,     0.3236 },
  {    -3.702,    3.0849,    -0.654,     0.3242 },
  {   -0.6871,    3.0785,   -0.6533,     0.3248 },
  {    2.3276,    3.0726,   -0.6525,     0.3255 },
  {    5.3411,     3.068,    -0.652,     0.3259 },
  {    8.3554,    3.0614,   -0.6511,     0.3266 },
  {     11.37,    3.0589,   -0.6508,     0.3269 },
  {  -12.7375,    3.1917,   -0.2403,     0.3133 },
  {   -9.7237,    3.1881,   -0.2398,     0.3137 },
  {   -6.7092,    3.1833,   -0.2389,     0.3141 },
  {   -3.6945,      3.18,   -0.2376,     0.3145 },
  {   -0.6796,    3.1748,   -0.2359,     0.3150 },
  {    2.3362,    3.1716,   -0.2339,     0.3153 },
  {    5.3497,    3.1676,   -0.2322,     0.3157 },
  {    8.3634,    3.1641,   -0.2311,     0.3160 },
  {   11.3775,    3.1623,   -0.2302,     0.3162 }
};

const coords_t mapL1[] = {
  {  -12.7551,    3.9372,    0.1316,     0.2540 },
  {   -9.7417,    3.9384,    0.1321,     0.2539 },
  {   -6.7275,    3.9397,    0.1324,     0.2538 },
  {   -3.7128,    3.9408,    0.1325,     0.2538 },
  {   -0.6989,    3.9424,    0.1323,     0.2537 },
  {    2.3156,    3.9435,    0.1323,     0.2536 },
  {    5.3301,    3.9431,    0.1321,     0.2536 },
  {    8.3338,    3.8705,    0.1474,     0.2584 },
  {   11.3578,    3.9441,    0.1318,     0.2535 },
  {  -12.7608,    3.7885,     0.468,     0.2640 },
  {   -9.7471,    3.7878,    0.4678,     0.2640 },
  {   -6.7328,    3.7872,    0.4673,     0.2640 },
  {   -3.7189,    3.7875,    0.4669,     0.2640 },
  {   -0.7042,    3.7878,    0.4666,     0.2640 },
  {    2.3103,    3.7889,    0.4665,     0.2639 },
  {    5.3252,    3.7907,    0.4666,     0.2638 },
  {    8.2696,    3.7502,      0.49,     0.2667 },
  {    11.354,    3.7983,    0.4673,     0.2633 },
  {  -12.7489,    3.5858,    0.8186,     0.2789 },
  {   -9.7343,    3.5863,    0.8186,     0.2788 },
  {   -6.7203,    3.5868,    0.8185,     0.2788 },
  {   -3.7066,    3.5876,    0.8184,     0.2787 },
  {   -0.6922,    3.5892,    0.8186,     0.2786 },
  {    2.3221,    3.5911,    0.8186,     0.2785 },
  {    5.3367,    3.5946,    0.8183,     0.2782 },
  {    8.3515,    3.5977,    0.8178,     0.2780 },
  {   11.3666,    3.6017,    0.8173,     0.2776 },
  {  -12.7651,    3.3359,    1.1909,     0.2998 },
  {   -9.7509,    3.3396,    1.1909,     0.2994 },
  {   -6.7356,    3.3431,    1.1903,     0.2991 },
  {   -3.7212,    3.3473,    1.1896,     0.2987 },
  {   -0.7067,    3.3518,    1.1887,     0.2983 },
  {    2.3076,    3.3553,    1.1878,     0.2980 },
  {    5.3221,    3.3575,    1.1872,     0.2978 },
  {    8.3369,    3.3597,    1.1864,     0.2976 },
  {   11.3516,    3.3611,    1.1857,     0.2975 },
  {  -12.6963,    3.1202,    1.5827,     0.3205 },
  {   -9.6816,    3.1181,    1.5832,     0.3207 },
  {   -6.6679,    3.1164,    1.5834,     0.3209 },
  {   -3.6538,    3.1143,    1.5837,     0.3211 },
  {   -0.6396,     3.113,    1.5842,     0.3212 },
  {    2.3743,     3.112,    1.5851,     0.3213 },
  {    5.3881,    3.1123,    1.5861,     0.3213 },
  {    8.4019,     3.111,    1.5869,     0.3214 },
  {   11.4161,    3.1114,    1.5873,     0.3214 },
  {  -12.7113,     2.839,    2.0215,     0.3522 },
  {   -9.6909,    2.8932,    2.0101,     0.3456 },
  {   -6.6749,     2.896,    2.0107,     0.3453 },
  {   -3.6605,     2.897,    2.0115,     0.3452 },
  {   -0.6462,    2.8975,     2.012,     0.3451 },
  {    2.3686,    2.8983,    2.0125,     0.3450 },
  {    5.3837,    2.8981,    2.0128,     0.3451 },
  {    8.3979,    2.8988,     2.013,     0.3450 },
  {   11.4119,    2.8974,    2.0131,     0.3451 },
  {  -12.6976,    2.7383,    2.4673,     0.3652 },
  {   -9.6828,    2.7402,    2.4682,     0.3649 },
  {   -6.6681,    2.7409,    2.4687,     0.3648 },
  {   -3.6533,    2.7404,    2.4695,     0.3649 },
  {   -0.6382,    2.7394,    2.4701,     0.3650 },
  {    2.3772,    2.7384,    2.4706,     0.3652 },
  {    5.3924,    2.7371,     2.471,     0.3654 },
  {    8.4068,    2.7366,     2.471,     0.3654 },
  {   11.4207,    2.7354,    2.4713,     0.3656 },
  {  -12.7064,     2.677,    2.9445,     0.3736 },
  {   -9.6898,    2.6769,    2.9457,     0.3736 },
  {   -6.6744,    2.6788,    2.9469,     0.3733 },
  {   -3.6575,      2.68,     2.948,     0.3731 },
  {   -0.6416,    2.6803,    2.9487,     0.3731 },
  {    2.3745,    2.6798,    2.9495,     0.3732 },
  {    5.3902,    2.6784,    2.9502,     0.3734 },
  {    8.4049,    2.6762,    2.9507,     0.3737 },
  {   11.4187,    2.6747,    2.9513,     0.3739 },
  {  -12.6987,    2.7441,   -2.8616,     0.3644 },
  {   -9.6836,    2.7466,   -2.8609,     0.3641 },
  {   -6.6691,    2.7479,     -2.86,     0.3639 },
  {   -3.6548,    2.7484,   -2.8592,     0.3638 },
  {     -0.64,    2.7476,   -2.8584,     0.3640 },
  {    2.3742,    2.7461,   -2.8577,     0.3642 },
  {    5.3887,    2.7449,    -2.857,     0.3643 },
  {    8.4031,    2.7436,   -2.8561,     0.3645 },
  {   11.4178,    2.7432,    -2.855,     0.3645 },
  {  -12.6989,    2.9744,   -2.3834,     0.3362 },
  {   -9.6709,     2.887,   -2.4041,     0.3464 },
  {   -6.6558,    2.8903,   -2.4029,     0.3460 },
  {   -3.6411,    2.8921,   -2.4016,     0.3458 },
  {   -0.6265,    2.8942,   -2.4003,     0.3455 },
  {    2.3883,    2.8941,   -2.3987,     0.3455 },
  {     5.403,    2.8931,   -2.3974,     0.3456 },
  {    8.4176,    2.8912,   -2.3961,     0.3459 },
  {   11.4325,    2.8877,   -2.3949,     0.3463 },
  {  -12.6841,    3.0703,   -1.9764,     0.3257 },
  {     -9.67,     3.074,   -1.9755,     0.3253 },
  {   -6.6546,    3.0756,   -1.9741,     0.3251 },
  {   -3.6391,     3.077,   -1.9728,     0.3250 },
  {   -0.6243,    3.0787,   -1.9713,     0.3248 },
  {    2.3915,    3.0803,   -1.9696,     0.3246 },
  {    5.4062,    3.0825,   -1.9681,     0.3244 },
  {    8.4205,     3.083,   -1.9667,     0.3244 },
  {   11.4359,    3.0815,   -1.9652,     0.3245 },
  {   -12.652,      3.33,   -1.5801,     0.3003 },
  {   -9.6821,    3.3447,   -1.5783,     0.2990 },
  {   -6.6676,    3.3466,    -1.577,     0.2988 },
  {   -3.6529,    3.3491,   -1.5755,     0.2986 },
  {   -0.6381,    3.3505,    -1.574,     0.2985 },
  {    2.3783,    3.3521,   -1.5722,     0.2983 },
  {     5.394,    3.3526,   -1.5709,     0.2983 },
  {    8.4096,     3.352,   -1.5697,     0.2983 },
  {   11.4246,    3.3517,   -1.5686,     0.2984 },
  {  -12.7623,    3.6009,   -1.1913,     0.2777 },
  {   -9.7477,    3.6002,   -1.1911,     0.2778 },
  {    -6.733,    3.5996,    -1.191,     0.2778 },
  {   -3.7171,    3.5988,   -1.1907,     0.2779 },
  {   -0.7025,    3.5976,   -1.1906,     0.2780 },
  {    2.3131,    3.5971,   -1.1903,     0.2780 },
  {    5.3277,    3.5972,     -1.19,     0.2780 },
  {    8.3415,    3.5961,   -1.1896,     0.2781 },
  {   11.3574,    3.5976,   -1.1892,     0.2780 },
  {  -12.7576,    3.7915,    -0.847,     0.2637 },
  {   -9.7431,    3.7938,   -0.8467,     0.2636 },
  {   -6.7287,    3.7973,   -0.8462,     0.2633 },
  {   -3.7135,    3.7992,   -0.8455,     0.2632 },
  {   -0.6979,     3.801,   -0.8446,     0.2631 },
  {    2.3173,    3.8013,   -0.8438,     0.2631 },
  {    5.3317,    3.8012,   -0.8429,     0.2631 },
  {    8.3469,    3.7999,    -0.842,     0.2632 },
  {   11.3627,    3.7989,   -0.8414,     0.2632 },
  {  -12.7793,     3.905,   -0.5098,     0.2561 },
  {   -9.7653,     3.907,   -0.5089,     0.2560 },
  {   -6.7503,     3.908,   -0.5081,     0.2559 },
  {   -3.7348,    3.9087,   -0.5075,     0.2558 },
  {    -0.719,    3.9101,   -0.5073,     0.2557 },
  {    2.2966,    3.9117,   -0.5069,     0.2556 },
  {    5.3117,    3.9121,   -0.5065,     0.2556 },
  {    8.3272,    3.9136,   -0.5059,     0.2555 },
  {   11.3433,    3.9144,   -0.5056,     0.2555 },
  {  -12.7737,    3.9389,   -0.1793,     0.2539 },
  {   -9.7591,    3.9394,   -0.1788,     0.2538 },
  {   -6.7437,    3.9411,   -0.1781,     0.2537 },
  {   -3.7285,    3.9434,   -0.1777,     0.2536 },
  {   -0.7126,    3.9463,   -0.1772,     0.2534 },
  {    2.3041,    3.9484,   -0.1765,     0.2533 },
  {    5.3201,    3.9507,   -0.1761,     0.2531 },
  {    8.3358,     3.952,   -0.1756,     0.2530 },
  {   11.3519,    3.9533,   -0.1754,     0.2530 }
};

const coords_t mapL2[] = {
  {  -12.7608,    4.7284,    0.1072,     0.2115 },
  {   -9.7468,    4.7293,    0.1076,     0.2114 },
  {   -6.7317,     4.732,    0.1078,     0.2113 },
  {   -3.7171,    4.7341,     0.108,     0.2112 },
  {   -0.7035,     4.737,    0.1081,     0.2111 },
  {    2.3112,    4.7394,    0.1081,     0.2110 },
  {     5.327,    4.7428,    0.1081,     0.2108 },
  {    8.3465,    4.7489,    0.1083,     0.2106 },
  {   11.3564,    4.7558,    0.1078,     0.2103 },
  {  -12.7587,    4.6292,    0.3851,     0.2160 },
  {   -9.7445,    4.6299,    0.3846,     0.2160 },
  {   -6.7304,    4.6311,    0.3841,     0.2159 },
  {   -3.7162,    4.6341,    0.3837,     0.2158 },
  {   -0.7019,    4.6369,    0.3834,     0.2157 },
  {    2.3116,    4.6406,    0.3833,     0.2155 },
  {    5.3274,    4.6438,     0.383,     0.2153 },
  {    8.3509,    4.6528,    0.3832,     0.2149 },
  {    11.357,    4.6605,     0.383,     0.2146 },
  {  -12.7565,    4.4963,    0.6696,     0.2224 },
  {    -9.743,    4.4999,     0.669,     0.2222 },
  {   -6.7287,    4.5033,    0.6682,     0.2221 },
  {   -3.7149,     4.506,    0.6673,     0.2219 },
  {   -0.7003,    4.5088,    0.6666,     0.2218 },
  {    2.3141,    4.5118,     0.666,     0.2216 },
  {    5.3289,    4.5148,    0.6654,     0.2215 },
  {    8.3468,    4.5189,    0.6647,     0.2213 },
  {   11.3617,     4.522,     0.664,     0.2211 },
  {  -12.7556,    4.3151,    0.9623,     0.2317 },
  {   -9.7417,    4.3179,    0.9618,     0.2316 },
  {   -6.7263,    4.3218,    0.9607,     0.2314 },
  {   -3.7125,    4.3275,    0.9597,     0.2311 },
  {   -0.6986,    4.3317,    0.9589,     0.2309 },
  {     2.316,    4.3362,     0.958,     0.2306 },
  {    5.3302,    4.3401,    0.9571,     0.2304 },
  {     8.345,    4.3443,    0.9561,     0.2302 },
  {    11.361,    4.3486,     0.955,     0.2300 },
  {  -12.7481,    4.1264,    1.2683,     0.2423 },
  {   -9.7344,    4.1259,    1.2671,     0.2424 },
  {    -6.719,    4.1276,    1.2657,     0.2423 },
  {   -3.7052,    4.1299,    1.2644,     0.2421 },
  {   -0.6912,    4.1349,    1.2631,     0.2418 },
  {    2.3227,    4.1386,    1.2617,     0.2416 },
  {    5.3376,    4.1419,    1.2603,     0.2414 },
  {    8.3527,    4.1468,     1.259,     0.2411 },
  {   11.3674,    4.1521,    1.2576,     0.2408 },
  {  -12.6997,    3.9562,    1.5803,     0.2528 },
  {   -9.6833,    3.9579,    1.5801,     0.2527 },
  {   -6.6689,    3.9601,    1.5793,     0.2525 },
  {   -3.6551,    3.9603,    1.5786,     0.2525 },
  {   -0.6413,    3.9608,    1.5778,     0.2525 },
  {    2.3715,    3.9592,    1.5769,     0.2526 },
  {    5.3857,    3.9588,    1.5763,     0.2526 },
  {    8.3988,    3.9577,    1.5758,     0.2527 },
  {   11.4131,    3.9588,    1.5752,     0.2526 },
  {  -12.6996,    3.7638,    1.9119,     0.2657 },
  {   -9.6959,    3.7835,    1.9112,     0.2643 },
  {   -6.6771,    3.7886,    1.9111,     0.2639 },
  {   -3.6627,     3.791,    1.9105,     0.2638 },
  {   -0.6466,    3.7932,    1.9097,     0.2636 },
  {    2.3697,    3.7942,    1.9091,     0.2636 },
  {    5.3857,    3.7937,    1.9082,     0.2636 },
  {    8.4014,    3.7947,    1.9075,     0.2635 },
  {   11.4149,    3.7954,    1.9067,     0.2635 },
  {  -12.7075,     3.641,    2.2559,     0.2746 },
  {   -9.6904,    3.6397,     2.255,     0.2747 },
  {   -6.6749,    3.6402,    2.2543,     0.2747 },
  {   -3.6589,    3.6421,     2.254,     0.2746 },
  {   -0.6428,    3.6433,    2.2538,     0.2745 },
  {    2.3732,    3.6432,    2.2536,     0.2745 },
  {    5.3888,    3.6416,    2.2533,     0.2746 },
  {    8.4047,    3.6413,    2.2528,     0.2746 },
  {   11.4183,    3.6412,    2.2523,     0.2746 },
  {  -12.7122,    3.5393,    2.6145,     0.2825 },
  {   -9.6969,    3.5431,    2.6143,     0.2822 },
  {   -6.6805,    3.5441,    2.6144,     0.2822 },
  {   -3.6626,    3.5462,    2.6144,     0.2820 },
  {   -0.6464,    3.5442,    2.6141,     0.2822 },
  {    2.3701,    3.5424,    2.6139,     0.2823 },
  {    5.3864,    3.5413,    2.6139,     0.2824 },
  {    8.4023,    3.5388,    2.6137,     0.2826 },
  {   11.4154,     3.538,    2.6137,     0.2826 },
  {   -12.721,    3.4983,    2.9784,     0.2859 },
  {   -9.7026,    3.4965,    2.9785,     0.2860 },
  {   -6.6848,    3.4968,    2.9788,     0.2860 },
  {    -3.665,    3.4976,    2.9789,     0.2859 },
  {   -0.6473,    3.4988,    2.9787,     0.2858 },
  {    2.3701,    3.4998,    2.9787,     0.2857 },
  {    5.3864,    3.5001,    2.9786,     0.2857 },
  {    8.4024,    3.4993,    2.9782,     0.2858 },
  {   11.4154,    3.4978,     2.978,     0.2859 },
  {  -12.6902,    3.5732,   -2.9396,     0.2799 },
  {   -9.6739,    3.5693,   -2.9395,     0.2802 },
  {   -6.6587,    3.5667,   -2.9394,     0.2804 },
  {   -3.6438,    3.5635,   -2.9391,     0.2806 },
  {   -0.6289,    3.5616,   -2.9388,     0.2808 },
  {     2.386,    3.5581,   -2.9384,     0.2810 },
  {    5.4007,    3.5539,   -2.9384,     0.2814 },
  {    8.4163,     3.552,   -2.9384,     0.2815 },
  {   11.4305,    3.5497,   -2.9387,     0.2817 },
  {  -12.6897,    3.6382,   -2.5829,     0.2749 },
  {   -9.6731,    3.6375,   -2.5826,     0.2749 },
  {   -6.6578,    3.6368,   -2.5825,     0.2750 },
  {   -3.6418,    3.6337,   -2.5823,     0.2752 },
  {    -0.627,    3.6324,    -2.582,     0.2753 },
  {    2.3882,    3.6318,   -2.5815,     0.2753 },
  {    5.4021,    3.6301,   -2.5809,     0.2755 },
  {    8.4181,    3.6302,   -2.5802,     0.2755 },
  {   11.4331,    3.6288,   -2.5798,     0.2756 },
  {  -12.6803,    3.7489,    -2.237,     0.2667 },
  {   -9.6686,    3.7495,   -2.2366,     0.2667 },
  {   -6.6526,    3.7487,   -2.2361,     0.2668 },
  {   -3.6373,    3.7444,   -2.2354,     0.2671 },
  {   -0.6203,    3.7433,   -2.2345,     0.2671 },
  {    2.3955,    3.7439,   -2.2336,     0.2671 },
  {    5.4106,    3.7455,   -2.2327,     0.2670 },
  {    8.4249,    3.7479,   -2.2322,     0.2668 },
  {   11.4399,    3.7489,   -2.2316,     0.2667 },
  {  -12.6819,    3.8867,   -1.9054,     0.2573 },
  {   -9.6624,    3.8802,   -1.9046,     0.2577 },
  {   -6.6455,    3.8782,   -1.9038,     0.2579 },
  {   -3.6295,    3.8788,   -1.9026,     0.2578 },
  {   -0.6114,    3.8805,   -1.9017,     0.2577 },
  {    2.4039,    3.8834,   -1.9005,     0.2575 },
  {    5.4195,    3.8886,   -1.8995,     0.2572 },
  {    8.4331,    3.8939,   -1.8987,     0.2568 },
  {   11.4483,    3.8975,   -1.8979,     0.2566 },
  {  -12.6249,    4.1227,   -1.5895,     0.2426 },
  {    -9.695,    4.1437,   -1.5879,     0.2413 },
  {   -6.6789,     4.142,   -1.5874,     0.2414 },
  {   -3.6628,    4.1431,   -1.5865,     0.2414 },
  {   -0.6474,    4.1462,   -1.5855,     0.2412 },
  {    2.3703,     4.151,   -1.5844,     0.2409 },
  {    5.3874,    4.1549,   -1.5834,     0.2407 },
  {    8.4036,    4.1588,   -1.5826,     0.2405 },
  {   11.4184,    4.1633,    -1.582,     0.2402 },
  {  -12.7498,    4.3428,   -1.2796,     0.2303 },
  {   -9.7358,    4.3412,   -1.2787,     0.2304 },
  {   -6.7209,    4.3404,   -1.2775,     0.2304 },
  {   -3.7051,    4.3385,   -1.2762,     0.2305 },
  {   -0.6899,    4.3394,   -1.2751,     0.2304 },
  {     2.327,    4.3386,   -1.2739,     0.2305 },
  {    5.3406,    4.3424,    -1.273,     0.2303 },
  {    8.3546,    4.3442,   -1.2722,     0.2302 },
  {   11.3705,    4.3489,   -1.2715,     0.2299 },
  {  -12.7668,    4.4981,   -0.9899,     0.2223 },
  {   -9.7536,       4.5,    -0.989,     0.2222 },
  {   -6.7379,    4.5023,    -0.988,     0.2221 },
  {   -3.7222,    4.5034,   -0.9869,     0.2221 },
  {   -0.7062,    4.5055,    -0.986,     0.2220 },
  {    2.3096,    4.5088,    -0.985,     0.2218 },
  {    5.3247,    4.5098,   -0.9841,     0.2217 },
  {    8.3411,    4.5129,    -0.983,     0.2216 },
  {   11.3571,    4.5154,   -0.9821,     0.2215 },
  {  -12.7721,    4.6151,   -0.7071,     0.2167 },
  {   -9.7572,    4.6174,   -0.7062,     0.2166 },
  {   -6.7419,    4.6208,   -0.7054,     0.2164 },
  {   -3.7265,    4.6256,   -0.7045,     0.2162 },
  {   -0.7094,    4.6282,   -0.7038,     0.2161 },
  {    2.3062,     4.631,   -0.7029,     0.2159 },
  {    5.3225,    4.6343,   -0.7023,     0.2158 },
  {    8.3382,    4.6368,   -0.7017,     0.2157 },
  {   11.3555,    4.6404,   -0.7011,     0.2155 },
  {  -12.7835,    4.6822,     -0.43,     0.2136 },
  {   -9.7689,    4.6833,   -0.4293,     0.2135 },
  {   -6.7522,    4.6857,   -0.4288,     0.2134 },
  {   -3.7367,    4.6897,   -0.4281,     0.2132 },
  {   -0.7207,    4.6909,   -0.4276,     0.2132 },
  {     2.297,    4.6949,   -0.4269,     0.2130 },
  {    5.3148,    4.6992,   -0.4263,     0.2128 },
  {    8.3318,    4.7026,   -0.4259,     0.2126 },
  {   11.3487,    4.7085,   -0.4254,     0.2124 },
  {  -12.7963,     4.697,   -0.1548,     0.2129 },
  {   -9.7795,    4.6991,   -0.1545,     0.2128 },
  {   -6.7635,    4.7023,   -0.1542,     0.2127 },
  {   -3.7477,    4.7055,   -0.1537,     0.2125 },
  {   -0.7297,    4.7095,   -0.1532,     0.2123 },
  {    2.2875,    4.7128,   -0.1527,     0.2122 },
  {    5.3065,    4.7176,   -0.1522,     0.2120 },
  {    8.3249,    4.7208,   -0.1517,     0.2118 },
  {   11.3417,    4.7238,   -0.1513,     0.2117 },

  // add dummy 8 staves for the telescope
  {   -9.7237,    3.1881,   -0.2398,     0.3137 },
  {   -6.7092,    3.1833,   -0.2389,     0.3141 },
  {   -3.6945,      3.18,   -0.2376,     0.3145 },
  {   -0.6796,    3.1748,   -0.2359,     0.3150 },
  {    2.3362,    3.1716,   -0.2339,     0.3153 },
  {    5.3497,    3.1676,   -0.2322,     0.3157 },
  {    8.3634,    3.1641,   -0.2311,     0.3160 },
  {   11.3775,    3.1623,   -0.2302,     0.3162 }
};

struct phitilt_t {
  sincos_t cosphi;
  sincos_t sinphi;
};

const phitilt_t phiTilts[] = {
  { 0.97308189, 0.23045963 },
  { 0.95668868, 0.29111298 },
  { 0.95612798, 0.29294929 }
};


constexpr int NUM_CHIPS_PER_STAVE = 9;

// bcid is used to indicate that it's the end of the bcid
void getCoords(ap_uint<1> bcid, ap_uint<2> layer, ap_uint<5> stave, ap_uint<4> chip,
               ap_ufixed<11, 10> col, ap_ufixed<10,9> row, ap_uint<4> nConstituents, out_t& outval) {

#pragma HLS pipeline
#pragma HLS AGGREGATE variable=outval compact=bit
#pragma HLS interface mode=ap_none port=outval

  const ap_ufixed<8, -7> pix_phi = 0.002688;
  const ap_ufixed<8, -7> pix_z = 0.002924;

  auto delrow = (row - 255) * pix_phi;

  coords_t coords;
  if (bcid == 0) {
    if (layer == 0) {
      coords = mapL0[stave*NUM_CHIPS_PER_STAVE + chip];
    } else if (layer == 1) {
      coords = mapL1[stave*NUM_CHIPS_PER_STAVE + chip];
    } else {
      coords = mapL2[stave*NUM_CHIPS_PER_STAVE + chip];
    }
  }
  auto phitilt = (bcid == 0) ? phiTilts[layer] : phitilt_t{0, 0};

  // using order 2 Taylor expansion

  ap_ufixed<1, 0> half = 0.5;

  outval.z = coords.z + (col - 511) * pix_z;
  outval.phi = coords.phi + delrow * phitilt.cosphi * coords.r_inv
    + delrow * delrow * phitilt.sinphi * phitilt.cosphi * coords.r_inv * coords.r_inv;
  outval.r = coords.r - delrow * phitilt.sinphi + delrow * delrow * phitilt.cosphi * phitilt.cosphi * coords.r_inv * half;
  outval.nConst_or_chipid = (bcid == 0) ? nConstituents : chip;
  outval.bcid = bcid;
}
