#include "ap_fixed.h"
#include "ap_int.h"

using x_t = ap_fixed<16, 4, AP_RND>;
using y_t = ap_fixed<16, 4, AP_RND>;
using z_t = ap_fixed<16, 6, AP_RND>;
using r_t = ap_ufixed<16, 3, AP_RND>;
using sincos_t = ap_fixed<16, 2, AP_RND>;

struct coords_t {
  x_t x;
  y_t y;
  z_t z;
  sincos_t cosphi;
  sincos_t sinphi;
};


const coords_t mapL0[] = {
  {  3.1268,     0.4325,   -12.729,    0.99058,   0.13697 },
  {  3.1183,      0.434,   -9.7149,    0.99045,   0.13786 },
  {  3.1128,     0.4373,    -6.701,    0.99027,   0.13915 },
  {  3.1083,     0.4421,   -3.6867,    0.99003,   0.14083 },
  {  3.1044,     0.4463,   -0.6721,    0.98982,   0.14232 },
  {  3.0992,     0.4506,     2.342,    0.98959,   0.14390 },
  {  3.0957,     0.4556,    5.3548,    0.98935,   0.14558 },
  {  3.0911,     0.4606,    8.3703,    0.98908,   0.14736 },
  {   3.084,     0.4635,   11.3815,    0.98889,   0.14865 },
  {  2.4752,     1.5721,  -12.7251,    0.84411,   0.53618 },
  {  2.4716,     1.5776,     -9.71,    0.84292,   0.53803 },
  {  2.4666,     1.5838,   -6.6959,    0.84147,   0.54031 },
  {  2.4617,     1.5907,    -3.682,    0.83990,   0.54274 },
  {  2.4563,     1.5982,   -0.6669,    0.83821,   0.54534 },
  {   2.451,     1.6031,     2.349,    0.83690,   0.54735 },
  {  2.4465,      1.607,    5.3627,    0.83580,   0.54903 },
  {  2.4403,     1.6109,     8.375,    0.83454,   0.55095 },
  {  2.4324,     1.6097,     11.39,    0.83393,   0.55187 },
  {  1.3597,     2.2326,  -12.7152,    0.52012,   0.85409 },
  {  1.3541,     2.2361,   -9.6996,    0.51799,   0.85539 },
  {  1.3481,     2.2421,    -6.685,    0.51525,   0.85704 },
  {  1.3412,     2.2489,    -3.671,    0.51224,   0.85884 },
  {  1.3345,     2.2556,    -0.656,    0.50924,   0.86063 },
  {  1.3271,     2.2626,    2.3586,    0.50596,   0.86256 },
  {  1.3202,     2.2667,    5.3733,    0.50329,   0.86412 },
  {  1.3135,     2.2713,    8.3873,    0.50060,   0.86568 },
  {  1.3079,     2.2742,   11.4021,    0.49852,   0.86688 },
  { -0.0208,     2.2881,  -12.6973,   -0.00910,   0.99996 },
  { -0.0207,     2.2845,    -9.684,   -0.00910,   0.99996 },
  { -0.0191,     2.2809,     -6.67,   -0.00840,   0.99996 },
  { -0.0181,     2.2764,   -3.6547,   -0.00800,   0.99997 },
  { -0.0172,      2.272,   -0.6393,   -0.00760,   0.99997 },
  { -0.0165,     2.2673,    2.3754,   -0.00730,   0.99997 },
  { -0.0151,     2.2638,    5.3891,   -0.00670,   0.99998 },
  { -0.0139,     2.2608,     8.404,   -0.00610,   0.99998 },
  { -0.0121,     2.2598,    11.418,   -0.00540,   0.99999 },
  { -1.1398,      1.614,  -12.6883,   -0.57688,   0.81683 },
  { -1.1341,     1.6165,   -9.6773,   -0.57434,   0.81861 },
  { -1.1301,     1.6179,   -6.6631,   -0.57262,   0.81982 },
  { -1.1285,       1.62,   -3.6487,   -0.57156,   0.82056 },
  { -1.1289,     1.6217,    -0.635,   -0.57131,   0.82073 },
  { -1.1298,     1.6229,    2.3781,   -0.57139,   0.82068 },
  { -1.1309,     1.6247,    5.3929,   -0.57131,   0.82073 },
  { -1.1342,     1.6277,    8.4061,   -0.57172,   0.82045 },
  { -1.1384,     1.6294,   11.4205,   -0.57271,   0.81976 },
  { -1.7779,     0.4947,  -12.6917,   -0.96340,   0.26807 },
  { -1.7771,     0.4985,   -9.6766,   -0.96283,   0.27010 },
  {  -1.777,     0.5013,   -6.6633,   -0.96243,   0.27154 },
  { -1.7784,     0.5042,   -3.6488,   -0.96207,   0.27279 },
  { -1.7797,     0.5066,   -0.6351,   -0.96180,   0.27375 },
  {  -1.782,     0.5084,    2.3789,   -0.96164,   0.27433 },
  { -1.7837,     0.5105,    5.3931,   -0.96139,   0.27520 },
  { -1.7854,     0.5128,    8.4062,   -0.96114,   0.27606 },
  { -1.7889,     0.5152,   11.4205,   -0.96095,   0.27673 },
  { -1.7704,    -0.7888,  -12.6829,   -0.91346,  -0.40693 },
  { -1.7671,    -0.7823,   -9.6692,   -0.91439,  -0.40483 },
  { -1.7666,    -0.7766,   -6.6561,   -0.91544,  -0.40245 },
  { -1.7693,    -0.7726,   -3.6428,   -0.91644,  -0.40016 },
  { -1.7732,    -0.7698,   -0.6291,   -0.91728,  -0.39824 },
  {  -1.779,    -0.7685,    2.3847,   -0.91800,  -0.39658 },
  { -1.7861,     -0.768,    5.3986,   -0.91867,  -0.39502 },
  { -1.7937,    -0.7679,    8.4121,   -0.91930,  -0.39355 },
  { -1.8011,    -0.7685,    11.426,   -0.91977,  -0.39245 },
  { -1.1651,    -1.7638,   -12.754,   -0.55112,  -0.83443 },
  { -1.1141,    -1.8829,   -9.6696,   -0.50924,  -0.86062 },
  { -1.1168,     -1.879,   -6.6556,   -0.51088,  -0.85965 },
  { -1.1218,    -1.8768,    -3.642,   -0.51302,  -0.85837 },
  { -1.1284,    -1.8754,    -0.629,   -0.51560,  -0.85683 },
  { -1.1335,    -1.8753,    2.3853,   -0.51731,  -0.85580 },
  { -1.1407,    -1.8751,    5.3991,   -0.51979,  -0.85429 },
  { -1.1479,    -1.8756,    8.4136,   -0.52201,  -0.85294 },
  { -1.1546,    -1.8756,   11.4283,   -0.52422,  -0.85158 },
  {  0.0165,    -2.5115,  -12.6775,    0.00660,  -0.99998 },
  {  0.0121,    -2.5099,   -9.6653,    0.00480,  -0.99999 },
  {   0.008,    -2.5083,    -6.652,    0.00320,  -0.99999 },
  {  0.0021,    -2.5086,   -3.6383,    0.00080,  -1.00000 },
  { -0.0038,    -2.5098,   -0.6247,   -0.00150,  -1.00000 },
  { -0.0097,    -2.5115,    2.3898,   -0.00390,  -0.99999 },
  { -0.0164,    -2.5138,    5.4039,   -0.00650,  -0.99998 },
  { -0.0239,     -2.515,    8.4185,   -0.00950,  -0.99995 },
  {   -0.03,    -2.5153,   11.4331,   -0.01190,  -0.99993 },
  {  1.3404,    -2.5415,  -12.7466,    0.46647,  -0.88454 },
  {   1.339,    -2.5406,   -9.7309,    0.46621,  -0.88468 },
  {  1.3363,    -2.5387,   -6.7172,    0.46576,  -0.88491 },
  {  1.3324,     -2.535,   -3.7018,    0.46523,  -0.88519 },
  {  1.3284,    -2.5302,   -0.6877,    0.46488,  -0.88537 },
  {  1.3255,    -2.5232,    2.3268,    0.46505,  -0.88528 },
  {  1.3209,    -2.5179,    5.3409,    0.46452,  -0.88556 },
  {  1.3161,    -2.5125,    8.3541,    0.46399,  -0.88584 },
  {  1.3144,    -2.5087,   11.3688,    0.46408,  -0.88579 },
  {  2.4592,    -1.8889,  -12.7466,    0.79305,  -0.60916 },
  {  2.4547,    -1.8855,    -9.732,    0.79305,  -0.60916 },
  {   2.451,    -1.8817,    -6.718,    0.79323,  -0.60892 },
  {  2.4484,    -1.8766,    -3.702,    0.79366,  -0.60837 },
  {  2.4446,    -1.8711,   -0.6871,    0.79408,  -0.60781 },
  {  2.4414,    -1.8656,    2.3276,    0.79457,  -0.60717 },
  {  2.4387,    -1.8615,    5.3411,    0.79487,  -0.60678 },
  {   2.435,    -1.8555,    8.3554,    0.79542,  -0.60606 },
  {  2.4336,    -1.8532,     11.37,    0.79560,  -0.60582 },
  {     3.1,    -0.7596,  -12.7375,    0.97127,  -0.23799 },
  {  3.0968,    -0.7571,   -9.7237,    0.97139,  -0.23751 },
  {  3.0929,    -0.7532,   -6.7092,    0.97160,  -0.23663 },
  {  3.0907,    -0.7484,   -3.6945,    0.97191,  -0.23537 },
  {  3.0868,    -0.7421,   -0.6796,    0.97230,  -0.23372 },
  {  3.0852,     -0.735,    2.3362,    0.97277,  -0.23177 },
  {  3.0825,    -0.7289,    5.3497,    0.97316,  -0.23012 },
  {    3.08,    -0.7247,    8.3634,    0.97342,  -0.22905 },
  {  3.0789,    -0.7216,   11.3775,    0.97362,  -0.22817 }
};

const coords_t mapL1[] = {
  {  3.9031,     0.5166,  -12.7551,    0.99135,   0.13122 },
  {  3.9041,     0.5187,   -9.7417,    0.99129,   0.13172 },
  {  3.9052,       0.52,   -6.7275,    0.99125,   0.13201 },
  {  3.9063,     0.5205,   -3.7128,    0.99123,   0.13211 },
  {   3.908,     0.5202,   -0.6989,    0.99126,   0.13191 },
  {  3.9091,     0.5201,    2.3156,    0.99126,   0.13191 },
  {  3.9087,     0.5194,    5.3301,    0.99129,   0.13172 },
  {  3.8285,     0.5686,    8.3338,    0.98916,   0.14687 },
  {  3.9099,     0.5184,   11.3578,    0.99133,   0.13142 },
  {  3.3811,     1.7092,  -12.7608,    0.89247,   0.45110 },
  {  3.3809,     1.7079,   -9.7471,    0.89256,   0.45092 },
  {  3.3811,     1.7062,   -6.7328,    0.89279,   0.45048 },
  {   3.382,      1.705,   -3.7189,    0.89297,   0.45012 },
  {  3.3829,      1.704,   -0.7042,    0.89310,   0.44985 },
  {  3.3839,     1.7042,    2.3103,    0.89315,   0.44976 },
  {  3.3854,     1.7053,    5.3252,    0.89310,   0.44985 },
  {  3.3088,      1.765,    8.2696,    0.88233,   0.47063 },
  {  3.3911,      1.711,    11.354,    0.89279,   0.45048 },
  {  2.4499,     2.6184,  -12.7489,    0.68324,   0.73019 },
  {  2.4503,     2.6186,   -9.7343,    0.68324,   0.73019 },
  {   2.451,     2.6187,   -6.7203,    0.68332,   0.73012 },
  {  2.4517,     2.6191,   -3.7066,    0.68339,   0.73005 },
  {  2.4524,     2.6207,   -0.6922,    0.68324,   0.73019 },
  {  2.4535,     2.6223,    2.3221,    0.68324,   0.73019 },
  {  2.4567,      2.624,    5.3367,    0.68346,   0.72998 },
  {  2.4602,     2.6251,    8.3515,    0.68383,   0.72964 },
  {  2.4643,     2.6268,   11.3666,    0.68419,   0.72930 },
  {   1.237,     3.0981,  -12.7651,    0.37082,   0.92870 },
  {  1.2384,     3.1015,   -9.7509,    0.37082,   0.92870 },
  {  1.2416,      3.104,   -6.7356,    0.37138,   0.92848 },
  {  1.2452,     3.1071,   -3.7212,    0.37203,   0.92822 },
  {  1.2498,     3.1101,   -0.7067,    0.37287,   0.92789 },
  {  1.2539,     3.1122,    2.3076,    0.37370,   0.92755 },
  {  1.2566,     3.1135,    5.3221,    0.37426,   0.92732 },
  {  1.2599,     3.1145,    8.3369,    0.37500,   0.92702 },
  {  1.2627,     3.1149,   11.3516,    0.37565,   0.92676 },
  {  -0.037,       3.12,  -12.6963,   -0.01190,   0.99993 },
  { -0.0387,     3.1179,   -9.6816,   -0.01240,   0.99992 },
  { -0.0392,     3.1161,   -6.6679,   -0.01260,   0.99992 },
  { -0.0401,      3.114,   -3.6538,   -0.01290,   0.99992 },
  { -0.0418,     3.1127,   -0.6396,   -0.01340,   0.99991 },
  { -0.0446,     3.1117,    2.3743,   -0.01430,   0.99990 },
  { -0.0477,      3.112,    5.3881,   -0.01530,   0.99988 },
  {   -0.05,     3.1106,    8.4019,   -0.01610,   0.99987 },
  { -0.0514,      3.111,   11.4161,   -0.01650,   0.99986 },
  { -1.2366,     2.5555,  -12.7113,   -0.43560,   0.90014 },
  { -1.2304,     2.6185,   -9.6909,   -0.42531,   0.90505 },
  { -1.2334,     2.6203,   -6.6749,   -0.42585,   0.90479 },
  { -1.2358,     2.6202,   -3.6605,   -0.42658,   0.90445 },
  { -1.2374,       2.62,   -0.6462,   -0.42703,   0.90424 },
  {  -1.239,     2.6202,    2.3686,   -0.42748,   0.90402 },
  { -1.2395,     2.6196,    5.3837,   -0.42775,   0.90390 },
  { -1.2405,     2.6199,    8.3979,   -0.42793,   0.90381 },
  { -1.2402,     2.6186,   11.4119,   -0.42802,   0.90377 },
  { -2.1389,     1.7097,  -12.6976,   -0.78115,   0.62434 },
  {  -2.142,     1.7089,   -9.6828,   -0.78171,   0.62364 },
  { -2.1434,     1.7082,   -6.6681,   -0.78202,   0.62325 },
  { -2.1445,     1.7062,   -3.6533,   -0.78252,   0.62262 },
  { -2.1446,     1.7044,   -0.6382,   -0.78289,   0.62216 },
  { -2.1447,     1.7026,    2.3772,   -0.78320,   0.62176 },
  { -2.1445,     1.7009,    5.3924,   -0.78345,   0.62145 },
  { -2.1441,     1.7006,    8.4068,   -0.78345,   0.62145 },
  { -2.1436,     1.6993,   11.4207,   -0.78364,   0.62122 },
  { -2.6252,     0.5241,  -12.7064,   -0.98064,   0.19582 },
  { -2.6257,     0.5211,   -9.6898,   -0.98087,   0.19464 },
  { -2.6282,     0.5183,   -6.6744,   -0.98111,   0.19347 },
  {   -2.63,     0.5155,   -3.6575,   -0.98132,   0.19239 },
  { -2.6306,     0.5137,   -0.6416,   -0.98145,   0.19170 },
  { -2.6305,     0.5116,    2.3745,   -0.98161,   0.19091 },
  { -2.6295,     0.5095,    5.3902,   -0.98174,   0.19023 },
  { -2.6276,     0.5077,    8.4049,   -0.98184,   0.18974 },
  { -2.6264,      0.506,   11.4187,   -0.98195,   0.18915 },
  { -2.6373,    -0.7584,  -12.6987,   -0.96106,  -0.27635 },
  { -2.6391,     -0.761,   -9.6836,   -0.96086,  -0.27702 },
  { -2.6397,    -0.7635,   -6.6691,   -0.96061,  -0.27789 },
  { -2.6395,     -0.766,   -3.6548,   -0.96039,  -0.27865 },
  { -2.6382,    -0.7676,     -0.64,   -0.96017,  -0.27942 },
  { -2.6362,    -0.7691,    2.3742,   -0.95997,  -0.28009 },
  { -2.6345,    -0.7707,    5.3887,   -0.95978,  -0.28077 },
  { -2.6326,    -0.7728,    8.4031,   -0.95952,  -0.28163 },
  { -2.6313,    -0.7754,   11.4178,   -0.95921,  -0.28269 },
  { -2.1597,    -2.0452,  -12.6989,   -0.72608,  -0.68761 },
  { -2.1369,    -1.9413,   -9.6709,   -0.74016,  -0.67243 },
  { -2.1369,    -1.9461,   -6.6558,   -0.73935,  -0.67332 },
  { -2.1357,      -1.95,   -3.6411,   -0.73847,  -0.67428 },
  { -2.1347,    -1.9543,   -0.6265,   -0.73760,  -0.67524 },
  { -2.1316,    -1.9575,    2.3883,   -0.73651,  -0.67642 },
  { -2.1282,    -1.9597,     5.403,   -0.73564,  -0.67738 },
  { -2.1243,    -1.9613,    8.4176,   -0.73475,  -0.67833 },
  { -2.1194,    -1.9615,   11.4325,   -0.73394,  -0.67922 },
  { -1.2115,    -2.8212,  -12.6841,   -0.39457,  -0.91886 },
  { -1.2103,    -2.8257,     -9.67,   -0.39375,  -0.91922 },
  { -1.2071,    -2.8288,   -6.6546,   -0.39246,  -0.91977 },
  { -1.2038,    -2.8318,   -3.6391,   -0.39126,  -0.92028 },
  { -1.2004,    -2.8351,   -0.6243,   -0.38988,  -0.92086 },
  { -1.1963,    -2.8385,    2.3915,   -0.38832,  -0.92153 },
  { -1.1928,    -2.8424,    5.4062,   -0.38693,  -0.92211 },
  { -1.1889,    -2.8445,    8.4205,   -0.38564,  -0.92265 },
  { -1.1841,     -2.845,   11.4359,   -0.38426,  -0.92323 },
  { -0.0311,    -3.3298,   -12.652,   -0.00930,  -0.99996 },
  { -0.0251,    -3.3446,   -9.6821,   -0.00750,  -0.99997 },
  { -0.0209,    -3.3466,   -6.6676,   -0.00620,  -0.99998 },
  { -0.0159,     -3.349,   -3.6529,   -0.00470,  -0.99999 },
  { -0.0107,    -3.3505,   -0.6381,   -0.00320,  -0.99999 },
  { -0.0048,    -3.3521,    2.3783,   -0.00140,  -1.00000 },
  { -0.0003,    -3.3526,     5.394,   -0.00010,  -1.00000 },
  {  0.0038,    -3.3519,    8.4096,    0.00110,  -1.00000 },
  {  0.0073,    -3.3517,   11.4246,    0.00220,  -1.00000 },
  {  1.3341,    -3.3446,  -12.7623,    0.37045,  -0.92885 },
  {  1.3344,    -3.3438,   -9.7477,    0.37064,  -0.92878 },
  {  1.3346,    -3.3431,    -6.733,    0.37073,  -0.92874 },
  {  1.3351,     -3.342,   -3.7171,    0.37101,  -0.92863 },
  {  1.3349,    -3.3407,   -0.7025,    0.37110,  -0.92859 },
  {  1.3358,    -3.3398,    2.3131,    0.37138,  -0.92848 },
  {  1.3369,    -3.3396,    5.3277,    0.37166,  -0.92837 },
  {  1.3377,     -3.338,    8.3415,    0.37203,  -0.92822 },
  {  1.3396,    -3.3389,   11.3574,    0.37240,  -0.92807 },
  {  2.5109,    -2.8409,  -12.7576,    0.66223,  -0.74930 },
  {  2.5133,    -2.8418,   -9.7431,    0.66246,  -0.74910 },
  {   2.517,    -2.8432,   -6.7287,    0.66283,  -0.74877 },
  {  2.5202,     -2.843,   -3.7135,    0.66336,  -0.74830 },
  {   2.524,     -2.842,   -0.6979,    0.66403,  -0.74771 },
  {  2.5266,    -2.8402,    2.3173,    0.66463,  -0.74717 },
  {  2.5291,    -2.8377,    5.3317,    0.66530,  -0.74658 },
  {  2.5307,    -2.8346,    8.3469,    0.66597,  -0.74598 },
  {  2.5317,    -2.8323,   11.3627,    0.66642,  -0.74558 },
  {  3.4084,    -1.9058,  -12.7793,    0.87284,  -0.48800 },
  {   3.412,    -1.9035,   -9.7653,    0.87328,  -0.48722 },
  {  3.4144,    -1.9012,   -6.7503,    0.87367,  -0.48652 },
  {  3.4161,    -1.8996,   -3.7348,    0.87396,  -0.48599 },
  {  3.4178,    -1.8995,    -0.719,    0.87406,  -0.48582 },
  {  3.4198,     -1.899,    2.2966,    0.87425,  -0.48547 },
  {   3.421,    -1.8977,    5.3117,    0.87445,  -0.48512 },
  {  3.4233,    -1.8965,    8.3272,    0.87474,  -0.48459 },
  {  3.4246,     -1.896,   11.3433,    0.87488,  -0.48433 },
  {  3.8757,    -0.7026,  -12.7737,    0.98397,  -0.17834 },
  {  3.8767,    -0.7005,   -9.7591,    0.98406,  -0.17785 },
  {  3.8788,    -0.6982,   -6.7437,    0.98418,  -0.17716 },
  {  3.8813,     -0.697,   -3.7285,    0.98425,  -0.17677 },
  {  3.8845,    -0.6956,   -0.7126,    0.98434,  -0.17627 },
  {  3.8871,    -0.6932,    2.3041,    0.98446,  -0.17559 },
  {  3.8896,    -0.6921,    5.3201,    0.98453,  -0.17519 },
  {  3.8912,    -0.6905,    8.3358,    0.98462,  -0.17470 },
  {  3.8927,    -0.6897,   11.3519,    0.98466,  -0.17450 }
};
 
const coords_t mapL2[] = {
  {  4.7012,     0.5061,  -12.7608,    0.99426,   0.10699 },
  {   4.702,     0.5078,   -9.7468,    0.99422,   0.10739 },
  {  4.7045,     0.5094,   -6.7317,    0.99420,   0.10759 },
  {  4.7065,     0.5105,   -3.7171,    0.99417,   0.10779 },
  {  4.7093,     0.5111,   -0.7035,    0.99416,   0.10789 },
  {  4.7118,     0.5113,    2.3112,    0.99416,   0.10789 },
  {  4.7151,     0.5118,     5.327,    0.99416,   0.10789 },
  {  4.7211,     0.5131,    8.3465,    0.99414,   0.10809 },
  {  4.7282,     0.5118,   11.3564,    0.99420,   0.10759 },
  {  4.2902,     1.7388,  -12.7587,    0.92676,   0.37565 },
  {  4.2917,     1.7371,   -9.7445,    0.92695,   0.37519 },
  {  4.2936,     1.7354,   -6.7304,    0.92714,   0.37472 },
  {  4.2972,     1.7347,   -3.7162,    0.92729,   0.37435 },
  {  4.3003,     1.7344,   -0.7019,    0.92740,   0.37408 },
  {  4.3038,     1.7356,    2.3116,    0.92744,   0.37398 },
  {  4.3073,     1.7356,    5.3274,    0.92755,   0.37370 },
  {  4.3154,     1.7395,    8.3509,    0.92747,   0.37389 },
  {  4.3229,     1.7414,    11.357,    0.92755,   0.37370 },
  {  3.5254,     2.7907,  -12.7565,    0.78407,   0.62067 },
  {    3.53,     2.7907,    -9.743,    0.78444,   0.62020 },
  {  3.5349,     2.7901,   -6.7287,    0.78494,   0.61957 },
  {  3.5393,     2.7887,   -3.7149,    0.78550,   0.61887 },
  {  3.5437,     2.7878,   -0.7003,    0.78593,   0.61832 },
  {  3.5477,     2.7875,    2.3141,    0.78630,   0.61785 },
  {  3.5516,     2.7874,    5.3289,    0.78667,   0.61737 },
  {  3.5569,     2.7873,    8.3468,    0.78710,   0.61682 },
  {  3.5611,     2.7869,   11.3617,    0.78753,   0.61627 },
  {  2.4665,     3.5406,  -12.7556,    0.57163,   0.82051 },
  {    2.47,     3.5417,   -9.7417,    0.57204,   0.82022 },
  {  2.4763,     3.5421,   -6.7263,    0.57295,   0.81959 },
  {  2.4828,     3.5444,   -3.7125,    0.57377,   0.81902 },
  {  2.4883,     3.5457,   -0.6986,    0.57442,   0.81856 },
  {  2.4939,     3.5473,     2.316,    0.57516,   0.81804 },
  {  2.4996,     3.5481,    5.3302,    0.57589,   0.81752 },
  {  2.5055,      3.549,     8.345,    0.57671,   0.81695 },
  {  2.5116,     3.5499,    11.361,    0.57761,   0.81631 },
  {  1.2292,     3.9391,  -12.7481,    0.29790,   0.95460 },
  {  1.2337,     3.9371,   -9.7344,    0.29905,   0.95424 },
  {  1.2397,     3.9371,    -6.719,    0.30039,   0.95382 },
  {  1.2458,     3.9376,   -3.7052,    0.30162,   0.95343 },
  {  1.2525,     3.9406,   -0.6912,    0.30286,   0.95303 },
  {  1.2591,     3.9425,    2.3227,    0.30420,   0.95261 },
  {  1.2653,     3.9439,    5.3376,    0.30553,   0.95218 },
  {  1.2719,     3.9469,    8.3527,    0.30677,   0.95178 },
  {  1.2793,     3.9501,   11.3674,    0.30810,   0.95135 },
  { -0.0375,      3.956,  -12.6997,   -0.00950,   0.99995 },
  { -0.0369,     3.9577,   -9.6833,   -0.00930,   0.99996 },
  { -0.0338,       3.96,   -6.6689,   -0.00850,   0.99996 },
  { -0.0307,     3.9602,   -3.6551,   -0.00780,   0.99997 },
  { -0.0276,     3.9607,   -0.6413,   -0.00700,   0.99998 },
  { -0.0242,     3.9592,    2.3715,   -0.00610,   0.99998 },
  { -0.0218,     3.9587,    5.3857,   -0.00550,   0.99998 },
  { -0.0199,     3.9576,    8.3988,   -0.00500,   0.99999 },
  { -0.0174,     3.9588,   11.4131,   -0.00440,   0.99999 },
  {  -1.259,      3.547,  -12.6996,   -0.33453,   0.94239 },
  { -1.2632,     3.5664,   -9.6959,   -0.33387,   0.94262 },
  { -1.2644,     3.5714,   -6.6771,   -0.33377,   0.94265 },
  { -1.2631,     3.5744,   -3.6627,   -0.33321,   0.94285 },
  { -1.2611,     3.5774,   -0.6466,   -0.33245,   0.94312 },
  { -1.2592,     3.5791,    2.3697,   -0.33189,   0.94332 },
  { -1.2558,     3.5798,    5.3857,   -0.33104,   0.94362 },
  { -1.2539,     3.5816,    8.4014,   -0.33038,   0.94385 },
  { -1.2512,     3.5832,   11.4149,   -0.32962,   0.94411 },
  { -2.3039,     2.8195,  -12.7075,   -0.63275,   0.77435 },
  { -2.3005,     2.8205,   -9.6904,   -0.63206,   0.77492 },
  {  -2.299,     2.8224,   -6.6749,   -0.63151,   0.77536 },
  { -2.2993,     2.8246,   -3.6589,   -0.63128,   0.77555 },
  { -2.2993,     2.8261,   -0.6428,   -0.63113,   0.77568 },
  { -2.2986,     2.8265,    2.3732,   -0.63097,   0.77581 },
  { -2.2968,      2.826,    5.3888,   -0.63074,   0.77600 },
  { -2.2953,     2.8268,    8.4047,   -0.63035,   0.77631 },
  { -2.2937,     2.8279,   11.4183,   -0.62996,   0.77663 },
  {  -3.059,     1.7802,  -12.7122,   -0.86427,   0.50302 },
  { -3.0617,      1.783,   -9.6969,   -0.86417,   0.50320 },
  { -3.0629,     1.7831,   -6.6805,   -0.86422,   0.50311 },
  { -3.0647,     1.7841,   -3.6626,   -0.86422,   0.50311 },
  { -3.0625,      1.784,   -0.6464,   -0.86407,   0.50337 },
  { -3.0605,     1.7838,    2.3701,   -0.86397,   0.50354 },
  { -3.0595,     1.7833,    5.3864,   -0.86397,   0.50354 },
  { -3.0571,     1.7824,    8.4023,   -0.86387,   0.50371 },
  { -3.0565,      1.782,   11.4154,   -0.86387,   0.50371 },
  { -3.4518,     0.5683,   -12.721,   -0.98671,   0.16247 },
  { -3.4501,     0.5677,   -9.7026,   -0.98673,   0.16237 },
  { -3.4505,     0.5668,   -6.6848,   -0.98678,   0.16207 },
  { -3.4514,     0.5666,    -3.665,   -0.98679,   0.16198 },
  { -3.4525,     0.5673,   -0.6473,   -0.98676,   0.16217 },
  { -3.4535,     0.5675,    2.3701,   -0.98676,   0.16217 },
  { -3.4537,      0.568,    5.3864,   -0.98675,   0.16227 },
  { -3.4527,     0.5691,    8.4024,   -0.98668,   0.16267 },
  { -3.4511,     0.5698,   11.4154,   -0.98665,   0.16286 },
  { -3.5006,    -0.7167,  -12.6902,   -0.97967,  -0.20062 },
  { -3.4966,    -0.7164,   -9.6739,   -0.97965,  -0.20072 },
  {  -3.494,    -0.7164,   -6.6587,   -0.97963,  -0.20082 },
  { -3.4907,    -0.7165,   -3.6438,   -0.97957,  -0.20111 },
  { -3.4886,    -0.7173,   -0.6289,   -0.97951,  -0.20141 },
  { -3.4849,    -0.7181,     2.386,   -0.97943,  -0.20180 },
  { -3.4807,    -0.7173,    5.4007,   -0.97943,  -0.20180 },
  { -3.4789,    -0.7167,    8.4163,   -0.97943,  -0.20180 },
  { -3.4769,    -0.7153,   11.4305,   -0.97949,  -0.20150 },
  { -3.0851,    -1.9284,  -12.6897,   -0.84795,  -0.53008 },
  { -3.0839,     -1.929,   -9.6731,   -0.84779,  -0.53033 },
  {  -3.083,    -1.9292,   -6.6578,   -0.84774,  -0.53042 },
  {   -3.08,     -1.928,   -3.6418,   -0.84763,  -0.53059 },
  { -3.0784,    -1.9282,    -0.627,   -0.84747,  -0.53084 },
  { -3.0768,    -1.9295,    2.3882,   -0.84721,  -0.53126 },
  { -3.0744,    -1.9303,    5.4021,   -0.84689,  -0.53177 },
  {  -3.073,    -1.9327,    8.4181,   -0.84651,  -0.53237 },
  {  -3.071,    -1.9331,   11.4331,   -0.84630,  -0.53270 },
  { -2.3168,    -2.9473,  -12.6803,   -0.61801,  -0.78617 },
  {  -2.316,    -2.9487,   -9.6686,   -0.61769,  -0.78642 },
  { -2.3139,    -2.9493,   -6.6526,   -0.61730,  -0.78673 },
  { -2.3093,    -2.9475,   -3.6373,   -0.61675,  -0.78716 },
  {  -2.306,    -2.9486,   -0.6203,   -0.61604,  -0.78772 },
  { -2.3038,    -2.9512,    2.3955,   -0.61533,  -0.78827 },
  { -2.3022,    -2.9544,    5.4106,   -0.61462,  -0.78882 },
  { -2.3021,    -2.9575,    8.4249,   -0.61423,  -0.78913 },
  { -2.3009,    -2.9598,   11.4399,   -0.61375,  -0.78950 },
  { -1.2762,    -3.6712,  -12.6819,   -0.32839,  -0.94454 },
  { -1.2714,     -3.666,   -9.6624,   -0.32764,  -0.94480 },
  { -1.2679,    -3.6651,   -6.6455,   -0.32688,  -0.94506 },
  { -1.2637,    -3.6671,   -3.6295,   -0.32575,  -0.94546 },
  { -1.2607,      -3.67,   -0.6114,   -0.32490,  -0.94575 },
  { -1.2575,    -3.6742,    2.4039,   -0.32376,  -0.94614 },
  { -1.2552,    -3.6804,    5.4195,   -0.32282,  -0.94646 },
  { -1.2542,    -3.6864,    8.4331,   -0.32206,  -0.94672 },
  { -1.2523,    -3.6909,   11.4483,   -0.32130,  -0.94698 },
  { -0.0772,    -4.1219,  -12.6249,   -0.01870,  -0.99983 },
  { -0.0708,     -4.143,    -9.695,   -0.01710,  -0.99985 },
  { -0.0686,    -4.1415,   -6.6789,   -0.01660,  -0.99986 },
  { -0.0649,    -4.1426,   -3.6628,   -0.01570,  -0.99988 },
  {  -0.061,    -4.1457,   -0.6474,   -0.01470,  -0.99989 },
  { -0.0564,    -4.1507,    2.3703,   -0.01360,  -0.99991 },
  { -0.0524,    -4.1546,    5.3874,   -0.01260,  -0.99992 },
  {  -0.049,    -4.1586,    8.4036,   -0.01180,  -0.99993 },
  { -0.0466,     -4.163,   11.4184,   -0.01120,  -0.99994 },
  {  1.2466,      -4.16,  -12.7498,    0.28710,  -0.95790 },
  {  1.2502,    -4.1573,   -9.7358,    0.28796,  -0.95764 },
  {  1.2548,    -4.1551,   -6.7209,    0.28911,  -0.95730 },
  {  1.2597,    -4.1516,   -3.7051,    0.29035,  -0.95692 },
  {  1.2644,     -4.151,   -0.6899,    0.29141,  -0.95660 },
  {  1.2693,    -4.1488,     2.327,    0.29255,  -0.95625 },
  {  1.2743,    -4.1512,    5.3406,    0.29341,  -0.95599 },
  {  1.2781,     -4.152,    8.3546,    0.29418,  -0.95575 },
  {  1.2821,    -4.1556,   11.3705,    0.29485,  -0.95554 },
  {  2.4683,    -3.7604,  -12.7668,    0.54877,  -0.83597 },
  {  2.4727,    -3.7597,   -9.7536,    0.54953,  -0.83548 },
  {  2.4779,    -3.7591,   -6.7379,    0.55036,  -0.83493 },
  {  2.4825,    -3.7574,   -3.7222,    0.55128,  -0.83432 },
  {  2.4871,    -3.7569,   -0.7062,    0.55203,  -0.83382 },
  {  2.4927,     -3.757,    2.3096,    0.55286,  -0.83327 },
  {  2.4966,    -3.7557,    5.3247,    0.55361,  -0.83277 },
  {  2.5025,    -3.7556,    8.3411,    0.55453,  -0.83216 },
  {  2.5074,    -3.7552,   11.3571,    0.55528,  -0.83167 },
  {  3.5086,    -2.9983,  -12.7721,    0.76025,  -0.64963 },
  {   3.513,    -2.9966,   -9.7572,    0.76083,  -0.64895 },
  {  3.5179,     -2.996,   -6.7419,    0.76135,  -0.64834 },
  {  3.5243,    -2.9958,   -3.7265,    0.76194,  -0.64765 },
  {  3.5286,    -2.9949,   -0.7094,    0.76239,  -0.64712 },
  {  3.5333,    -2.9937,    2.3062,    0.76297,  -0.64643 },
  {  3.5375,    -2.9937,    5.3225,    0.76336,  -0.64598 },
  {  3.5413,    -2.9933,    8.3382,    0.76375,  -0.64552 },
  {   3.546,    -2.9932,   11.3555,    0.76413,  -0.64506 },
  {  4.2561,    -1.9517,  -12.7835,    0.90897,  -0.41687 },
  {  4.2583,    -1.9496,   -9.7689,    0.90926,  -0.41623 },
  {  4.2615,    -1.9482,   -6.7522,    0.90947,  -0.41578 },
  {  4.2664,    -1.9471,   -3.7367,    0.90976,  -0.41514 },
  {  4.2687,    -1.9451,   -0.7207,    0.90996,  -0.41469 },
  {  4.2736,    -1.9439,     2.297,    0.91025,  -0.41405 },
  {  4.2785,    -1.9433,    5.3148,    0.91050,  -0.41350 },
  {  4.2825,    -1.9427,    8.3318,    0.91067,  -0.41314 },
  {  4.2889,    -1.9429,   11.3487,    0.91087,  -0.41269 },
  {  4.6409,    -0.7242,  -12.7963,    0.98804,  -0.15418 },
  {  4.6431,    -0.7233,   -9.7795,    0.98809,  -0.15389 },
  {  4.6465,    -0.7221,   -6.7635,    0.98813,  -0.15359 },
  {    4.65,    -0.7203,   -3.7477,    0.98821,  -0.15310 },
  {  4.6543,    -0.7188,   -0.7297,    0.98829,  -0.15260 },
  {   4.658,    -0.7167,    2.2875,    0.98836,  -0.15211 },
  {  4.6631,    -0.715,    5.3065,    0.98844,  -0.15161 },
  {  4.6666,    -0.7136,    8.3249,    0.98852,  -0.15112 },
  {  4.6699,    -0.7118,   11.3417,    0.98858,  -0.15072 },

  // Extra staves for telescope
  {     3.1,    -0.7596,  -12.7375,    0.97127,  -0.23799 },
  {  3.0968,    -0.7571,   -9.7237,    0.97139,  -0.23751 },
  {  3.0929,    -0.7532,   -6.7092,    0.97160,  -0.23663 },
  {  3.0907,    -0.7484,   -3.6945,    0.97191,  -0.23537 },
  {  3.0868,    -0.7421,   -0.6796,    0.97230,  -0.23372 },
  {  3.0852,     -0.735,    2.3362,    0.97277,  -0.23177 },
  {  3.0825,    -0.7289,    5.3497,    0.97316,  -0.23012 },
  {    3.08,    -0.7247,    8.3634,    0.97342,  -0.22905 },
  {  3.0789,    -0.7216,   11.3775,    0.97362,  -0.22817 }
};


struct phitilt_t {
  sincos_t cosphi;
  sincos_t sinphi;
};

const phitilt_t phiTilts[] = {
  { 0.97308189, 0.23045963 },
  { 0.95668868, 0.29111298 },
  { 0.95612798, 0.29294929 }
};

struct simple_coords_t {
  x_t x;
  y_t y;
  z_t z;
};


constexpr int NUM_CHIPS_PER_STAVE = 9;

// The position is not currently used
simple_coords_t getCoords(ap_uint<2> layer, ap_uint<5> stave, ap_uint<4> chip,
                          ap_ufixed<11, 10> col, ap_ufixed<10,9> row) {

# pragma HLS pipeline

  const ap_ufixed<8, -7> pix_phi = 0.002688;
  const ap_ufixed<8, -7> pix_z = 0.002924;

  coords_t coords;
  if (layer == 0) {
    coords = mapL0[stave*NUM_CHIPS_PER_STAVE + chip];
  } else if (layer == 1) {
    coords = mapL1[stave*NUM_CHIPS_PER_STAVE + chip];
  } else {
    coords = mapL2[stave*NUM_CHIPS_PER_STAVE + chip];
  }

  auto phitilt = phiTilts[layer];

  simple_coords_t fixed_coords;

  fixed_coords.z = coords.z + col * pix_z;
  fixed_coords.y = coords.y + row * (coords.cosphi * phitilt.cosphi - coords.sinphi * phitilt.sinphi);
  fixed_coords.x = coords.z - row * (coords.sinphi * phitilt.cosphi + coords.cosphi * phitilt.sinphi);

  return fixed_coords;
}
